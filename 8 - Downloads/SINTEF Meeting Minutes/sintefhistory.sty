% Package for History logs in SINTEF documents.
%
% by Federico Zenith, federico.zenith@sintef.no.

\ProvidesPackage{sintefhistory}[2013/09/19 write history logs in SINTEF style]

\RequirePackage{tabularx,sinteflabels}

\newcommand{\@SINTEFhline}{\multicolumn{3}{@{}c@{}}{\@separator}\\}
\newcommand{\historyentry}[3]{#1 & #2 & #3\\\@SINTEFhline}
\newcommand{\@historyTable}{
  \historyentry{2.0}{2012-12-21}{\hfill \begin{minipage}{0.7\textwidth}
      Insert the history with the \texttt{\textbackslash history\{\}} command.\\
      Use the \texttt{\textbackslash historyentry} command to add entries
      within it:\\
      \texttt{\textbackslash history\{}\\
      \hspace*{1em}\texttt{\textbackslash historyentry\{version\}\{date\}\{description\}}\\
      \hspace*{1em}\texttt{\textbackslash historyentry\{...\}\{...\}\{...\}}\\
      \texttt{\}}
    \end{minipage}
  }
}

\newcommand{\history}{\renewcommand{\@historyTable}}

\newcommand{\historypage}{
  \ifdefempty{\@historyTable}{}{% If NOT empty, add the following:
    \noindent{\Huge \@historylabel}\\
    \@separator\\
    \begin{tabularx}{\textwidth}{llX}
      \small\textbf{\@versionlabel} &
      \small\textbf{\@datelabel} &
      \small\textbf{\@versiondescriptionlabel}\\
      \@SINTEFhline
      \@historyTable
    \end{tabularx}
    \clearpage
  }
}
